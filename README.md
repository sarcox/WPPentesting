# WPPentesting
WordPress Pentesting CodePath Assignment

EXPLOIT 1: wordpress-cve-2017-1001000

Reference: http://www.hackandsecure.com/2017/02/10/wordpress-rest-api-exploit-step-by-step/

Description of Vulnerability: Unauthorized users can update posts via the Wordpress (WP) API by exploiting a vulnerability in the parsing of post IDs. When the ID contains both numbers and letters, posts can be modified.

STEPS TO RECREATE:
1: Confirm the WP instance is vulnerable. 

View page source and look for the meta tag with the name <generator>. It should list version 4.7 or 4.7.1.

2: Confirm WP API endpoint address.

Add the path “wp-json/wp/v2/posts/“ to the end of the base WP URL, e.g. http://wpdistillery.vm/wp-json/wp/v2/posts/.

Note: I had issues with this step. When I changed the permalink format from Plain to Post Name, then the API worked as expected.

3. Note post IDs.

4. Use the post ID to craft the vulnerability.

In the example below the value 5 is the post ID. Change the value of the title variable and content variable as desired.


curl -s -X POST --url "http://$1/wp-json/wp/v2/posts/11” --data '{"id”:”5”,”title":"11Hacked1","content”:”Robin Sparkles was here.”}’ -H 'Content-Type: application/json'| indent

FIX: Update to version 4.7.2 or beyond


